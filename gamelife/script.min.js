(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Canvas = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _router = require("./router");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Canvas = function () {
  function Canvas(where, cell) {
    _classCallCheck(this, Canvas);

    this.elem = where;
    this.cell = cell || 20;
  }

  _createClass(Canvas, [{
    key: "create",
    value: function create() {
      this.x = this.cell * _router.lifeGame.x || 0;
      this.y = this.cell * _router.lifeGame.y || 0;
      this.elem.innerHTML = "<canvas id=\"canvas\" width=\"" + this.x + "\" height=\"" + this.y + "\"></canvas>";
      this.canvas = this.elem.querySelector("#canvas");
    }
  }, {
    key: "render",
    value: function render(arr) {
      var _this = this;

      var can = this.canvas.getContext("2d");
      var square = function square(i, j) {
        var x = j * _this.cell;
        var y = i * _this.cell;
        can.fillRect(x, y, _this.cell, _this.cell);
      };
      can.clearRect(0, 0, this.x, this.y);
      arr.forEach(function (item, i) {
        item.forEach(function (elem, j) {
          if (elem) {
            can.fillStyle = "rgb(0,0,0)";
            square(i, j);
          }
        });
      });
    }
  }, {
    key: "clear",
    value: function clear() {
      this.elem.innerHTML = "";
    }
  }, {
    key: "refresh",
    value: function refresh() {
      this.clear();
      this.create();
    }
  }]);

  return Canvas;
}();

exports.Canvas = Canvas;

},{"./router":8}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Control = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _router = require("./router");

var _main = require("./main");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Control = function () {
  function Control(where) {
    _classCallCheck(this, Control);

    this.elem = where;
    this.createButtons();
    this.insertButtons(_router.lifeGame.run);
    var insertButtons = this.insertButtons.bind(this);
    _router.eb.on("play", insertButtons);
  }

  _createClass(Control, [{
    key: "createButtons",
    value: function createButtons() {
      var prev = "\n        <svg version=\"1.1\" id=\"prev\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 60 40\" style=\"enable-background:new 0 0 60 40;\" xml:space=\"preserve\">\n          <style type=\"text/css\">.st0{fill:#FFFFFF;}</style>\n          <path class=\"st0\" d=\"M28.5,17.4L46,7.4c2-1.1,4.5,0.3,4.5,2.6l0,20c0,2.3-2.5,3.7-4.5,2.6l-17.5-10C26.5,21.5,26.5,18.6,28.5,17.4z\"/>\n          <path class=\"st0\" d=\"M5.1,17.4l17.5-10c2-1.1,4.5,0.3,4.5,2.6l0,20c0,2.3-2.5,3.7-4.5,2.6l-17.5-10C3.1,21.5,3.1,18.6,5.1,17.4z\"/>\n        </svg>";
      var play = "\n        <svg version=\"1.1\" id=\"play\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 60 40\" style=\"enable-background:new 0 0 60 40;\" xml:space=\"preserve\">\n          <style type=\"text/css\">.st0{fill:#FFFFFF;}</style>\n          <path class=\"st0\" d=\"M42,17.4l-17.5-10C22.5,6.3,20,7.7,20,10v20c0,2.3,2.5,3.7,4.5,2.6l17.5-10C44,21.5,44,18.6,42,17.4z\"/>\n        </svg>";
      var pause = "\n        <svg version=\"1.1\" id=\"pause\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 60 40\" style=\"enable-background:new 0 0 60 40;\" xml:space=\"preserve\">\n          <style type=\"text/css\">.st0{fill:#FFFFFF;}</style>\n          <path class=\"st0\" d=\"M25,33L25,33c-1.7,0-3-1.3-3-3V10c0-1.6,1.3-3,3-3h0c1.6,0,3,1.3,3,3v20C28,31.7,26.7,33,25,33z\"/>\n          <path class=\"st0\" d=\"M37,33L37,33c-1.7,0-3-1.3-3-3V10c0-1.6,1.3-3,3-3h0c1.6,0,3,1.3,3,3v20C40,31.7,38.7,33,37,33z\"/>\n        </svg>";
      var next = "\n        <svg version=\"1.1\" id=\"next\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 60 40\" style=\"enable-background:new 0 0 60 40;\" xml:space=\"preserve\">\n          <style type=\"text/css\">.st0{fill:#FFFFFF;}</style>\n          <path class=\"st0\" d=\"M31.5,17.4l-17.5-10c-2-1.1-4.5,0.3-4.5,2.6v20c0,2.3,2.5,3.7,4.5,2.6l17.5-10C33.5,21.5,33.5,18.6,31.5,17.4z\"/>\n          <path class=\"st0\" d=\"M55,17.4l-17.5-10C35.5,6.3,33,7.7,33,10v20c0,2.3,2.5,3.7,4.5,2.6l17.5-10C57,21.5,57,18.6,55,17.4z\"/>\n        </svg>";

      var createButton = function createButton(id, html) {
        var button = document.createElement("button");
        button.id = id;
        button.className = "control";
        button.innerHTML = html;
        return button;
      };
      var _ref = [createButton("prev", prev), createButton("play", play), createButton("pause", pause), createButton("next", next)];
      this.prev = _ref[0];
      this.play = _ref[1];
      this.pause = _ref[2];
      this.next = _ref[3];

      this.events();
    }
  }, {
    key: "insertButtons",
    value: function insertButtons(bool) {
      this.elem.innerHTML = "";
      this.elem.appendChild(this.prev);
      bool ? this.elem.appendChild(this.pause) : this.elem.appendChild(this.play);
      this.elem.appendChild(this.next);
    }
  }, {
    key: "events",
    value: function events() {
      this.elem.addEventListener("click", function (e) {
        if (!(e.target.closest("#play") || e.target.closest("#pause"))) return;
        _router.lifeGame.run ? _router.lifeGame.stop() : _router.lifeGame.start();
      });
      this.elem.addEventListener("click", function (e) {
        if (!e.target.closest("#prev") || _router.lifeGame.run) return;
        if (!_router.lifeGame.history || _router.lifeGame.history.length < 1) return;
        _router.lifeGame.currentArr = _router.lifeGame.history[_router.lifeGame.history.length - 1];
        (0, _main.output)();
        _router.lifeGame.history.splice(-1, 1);
      });
      this.elem.addEventListener("click", function (e) {
        if (!e.target.closest("#next") || _router.lifeGame.run) return;
        if (!_router.lifeGame.currentArr) return;
        _router.lifeGame.stepGame();
      });
    }
  }]);

  return Control;
}();

;

exports.Control = Control;

},{"./main":6,"./router":8}],3:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
function EventBus() {
  this.event = {};
};

EventBus.prototype.on = function (str, cb) {
  if (str in this.event) {
    this.event[str].push(cb);
  } else {
    this.event[str] = [cb];
  }
};

EventBus.prototype.off = function (str, cb) {
  if (this.event[str]) {
    if (cb) {
      var number = void 0;
      this.event[str].forEach(function (func, i) {
        if (func === cb) number = i;
      });
      this.event[str].splice(number, 1);
      return;
    }
    delete this.event[str];
  }
};

EventBus.prototype.trigger = function (str) {
  if (str in this.event) {
    var arr = arguments;
    this.event[str].forEach(function (cb) {
      arr.slice = [].slice;
      cb.apply(this, arr.slice(1));
    });
  }
};

EventBus.prototype.once = function (str, cb) {
  var self = this;
  var temp = function temp() {
    cb.apply(this, arguments);
    self.off(str, temp);
  };
  this.on(str, temp);
};

exports.EventBus = EventBus;

},{}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Header = function () {
  function Header() {
    _classCallCheck(this, Header);

    this.elem = document.createElement("header");
    this.create();
  }

  _createClass(Header, [{
    key: "create",
    value: function create() {
      this.elem.innerHTML = "\n      <ul>\n        <li>\n          <a href=\"#Text\" class=\"route\">Text</a>\n        </li><li>\n          <a href=\"#Canvas\" class=\"route\">Canvas</a>\n        </li><li>\n          <a href=\"#SVG\" class=\"route\">SVG</a>\n        </li><li>\n          <a href=\"#About\" class=\"route\">About</a>\n        </li>\n      </ul>";
      document.body.appendChild(this.elem);
    }
  }]);

  return Header;
}();

exports.Header = Header;

},{}],5:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Input = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _router = require("./router");

var _main = require("./main");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Input = function () {
  function Input(where) {
    _classCallCheck(this, Input);

    this.elem = where;
    this.create();
  }

  _createClass(Input, [{
    key: "create",
    value: function create() {
      this.elem.innerHTML = "\n      <div id=\"width\" class=\"input\">\n        <div class=\"minus\">-</div><input type=\"text\"><div class=\"plus\">+</div>\n      </div>\n      <div id=\"height\" class=\"input\">\n        <div class=\"minus\">-</div><input type=\"text\"><div class=\"plus\">+</div>\n      </div>\n      <button id=\"create\">Create</button>";
      this.events();
    }
  }, {
    key: "count",
    value: function count(elem) {
      var input = elem.parentNode.querySelector("input");
      if (elem.classList.contains("plus")) {
        if (input.value === "") input.value = 1;
        input.value = +input.value + 1;
      }
      if (elem.classList.contains("minus")) {
        if (input.value === "") input.value = 1;
        input.value = +input.value - 1;
        if (+input.value < 1) input.value = 1;
      }
    }
  }, {
    key: "checkAndCreate",
    value: function checkAndCreate() {
      var inputs = document.querySelectorAll(".input input");
      if (+inputs[0].value > 1 && +inputs[1].value > 1) {
        _router.lifeGame.clearHistory();
        _router.lifeGame.createArr(+inputs[0].value, +inputs[1].value);
        _router.lifeGame.x = +inputs[0].value;
        _router.lifeGame.y = +inputs[1].value;
        (0, _main.session)("field", [_router.lifeGame.x, _router.lifeGame.y]);
        _router.eb.trigger("createField");
        inputs[0].value = inputs[1].value = "";
      }
    }
  }, {
    key: "events",
    value: function events() {
      var _this = this;

      this.elem.addEventListener("change", function (e) {
        if (!e.target.closest(".input") && !e.target.matches("input")) return;
        if (!(Number.isInteger(+e.target.value) && +e.target.value > 0)) {
          e.target.value = "";
        }
      });
      this.elem.addEventListener("click", function (e) {
        if (!(e.target.classList.contains("plus") || e.target.classList.contains("minus"))) return;
        e.target.onselectstart = function () {
          return false;
        };
        e.target.onmousedown = function () {
          return false;
        };
        _this.count(e.target);
      });
      this.elem.addEventListener("keypress", function (e) {
        if (e.keyCode !== 13) return;
        _this.checkAndCreate();
      });
      this.elem.addEventListener("click", function (e) {
        if (!e.target.matches("#create")) return;
        _this.checkAndCreate();
      });
    }
  }]);

  return Input;
}();

;

exports.Input = Input;

},{"./main":6,"./router":8}],6:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.output = exports.session = exports.Life = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _router = require("./router");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Life = function () {
  function Life() {
    _classCallCheck(this, Life);

    this.history = [];
    this.interval = 340;
    this.run = false;
  }

  _createClass(Life, [{
    key: "createArr",
    value: function createArr(x, y) {
      var arr = [];
      for (var i = 0; i < y; i++) {
        arr[i] = [];
        for (var j = 0; j < x; j++) {
          arr[i][j] = 0;
        }
      }
      this.currentArr = arr;
      output();
    }
  }, {
    key: "addHistory",
    value: function addHistory(obj) {
      if (JSON.stringify(obj) === JSON.stringify(this.history[this.history.length - 1])) {
        if (this.run) this.stop();
        return;
      };
      this.history.push(obj);
    }
  }, {
    key: "clearHistory",
    value: function clearHistory() {
      this.history = [];
    }
  }, {
    key: "stop",
    value: function stop() {
      _router.eb.trigger("play", this.run = false);
      clearTimeout(this.timer);
    }
  }, {
    key: "start",
    value: function start() {
      var _this = this;

      if (!this.currentArr) return;
      _router.eb.trigger("play", this.run = true);
      var recur = function recur() {
        _this.timer = setTimeout(recur, _this.interval);
        _this.stepGame();
      };
      this.timer = setTimeout(recur, this.interval);
    }
  }, {
    key: "stepGame",
    value: function stepGame() {
      this.addHistory(this.currentArr);
      this.countGeneration();
      output();
    }
  }, {
    key: "countGeneration",
    value: function countGeneration() {
      var arr = this.currentArr;
      var countAround = function countAround(arr, i, j) {
        var count = 0;
        for (var x = i - 1; x <= i + 1; x++) {
          if (!arr[x]) continue;
          for (var y = j - 1; y <= j + 1; y++) {
            if (!arr[x][y]) continue;
            if (x === i && y === j) continue;
            if (arr[x][y] === 1) {
              count++;
            }
          }
        }
        return count;
      };

      var newArr = arr.slice();
      for (var i = 0; i < arr.length; i++) {
        newArr[i] = arr[i].slice();
        for (var j = 0; j < arr[i].length; j++) {
          newArr[i][j] = arr[i][j];
          if (arr[i][j] === 1 && (countAround(arr, i, j) < 2 || countAround(arr, i, j) > 3)) {
            newArr[i][j] = 0;
          }
          if (arr[i][j] === 0 && countAround(arr, i, j) === 3) {
            newArr[i][j] = 1;
          }
        }
      }
      this.currentArr = newArr;
    }
  }]);

  return Life;
}();

;

document.body.addEventListener("click", function (e) {
  if (!(e.target.matches("#text") || e.target.matches("#canvas") || e.target.closest("#svg"))) return;
  var field = e.target.closest("#field").children[0];
  var coords = field.getBoundingClientRect();
  var cellWidth = coords.width / _router.lifeGame.x;
  var cellHeight = coords.height / _router.lifeGame.y;
  var i = Math.floor((e.clientY - coords.y) / cellHeight);
  var j = Math.floor((e.clientX - coords.x) / cellWidth);
  if (_router.lifeGame.run) _router.lifeGame.stop();
  _router.lifeGame.clearHistory();
  _router.lifeGame.currentArr[i][j] = _router.lifeGame.currentArr[i][j] === 0 ? 1 : 0;
  output();
});

var output = function output() {
  session("lastArray", _router.lifeGame.currentArr);
  session("field", [_router.lifeGame.x, _router.lifeGame.y]);
  _router.eb.trigger("changeArr", _router.lifeGame.currentArr);
};

var session = function session(name, obj) {
  if (name && obj) {
    var str = JSON.stringify(obj);
    Promise.resolve(str).then(function (str) {
      window.sessionStorage.setItem(name, str);
    });
  }
  if (name && !obj) {
    return Promise.resolve().then(function (_) {
      if (window.sessionStorage.getItem(name) === null) return false;
      var arr = JSON.parse(window.sessionStorage.getItem(name));
      return arr;
    });
  };
};

exports.Life = Life;
exports.session = session;
exports.output = output;

},{"./router":8}],7:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ControlPanel = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _router = require("./router");

var _slider = require("./slider");

var _input = require("./input");

var _control = require("./control");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var ControlPanel = function () {
  function ControlPanel() {
    _classCallCheck(this, ControlPanel);

    this.elem = document.createElement("footer");
    this.prevElem = document.querySelector("main");
  }

  _createClass(ControlPanel, [{
    key: "create",
    value: function create() {
      var _this = this;

      if (!this.prevElem) return;
      var createBlock = function createBlock() {
        var div = document.createElement("div");
        div.className = "block";
        _this.elem.appendChild(div);
        return div;
      };

      new _control.Control(createBlock());
      new _slider.Slider(createBlock());
      new _input.Input(createBlock());

      document.body.appendChild(this.elem);
    }
  }, {
    key: "delete",
    value: function _delete() {
      this.elem.innerHTML = "";
      document.body.removeChild(this.elem);
    }
  }]);

  return ControlPanel;
}();

exports.ControlPanel = ControlPanel;

},{"./control":2,"./input":5,"./router":8,"./slider":9}],8:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.eb = exports.lifeGame = undefined;

var _main = require("./main.js");

var _eb = require("./eb");

var _header = require("./header");

var _text = require("./text");

var _canvas = require("./canvas");

var _svg = require("./svg");

var _panel = require("./panel");

var lifeGame = new _main.Life();
var eb = new _eb.EventBus();
exports.lifeGame = lifeGame;
exports.eb = eb;


new _header.Header();
var main = document.createElement("main");
main.id = "field";
document.body.appendChild(main);
var controlPanel = new _panel.ControlPanel(document.querySelector("footer"));

var route = {
  routes: [],
  interpret: function interpret(hash) {
    var result = void 0;
    this.routes.forEach(function (iroute) {
      if (typeof iroute.match === "string" && iroute.match === hash) {
        result = iroute;
      }
      if (typeof iroute.match === "object" && iroute.match instanceof RegExp && hash.match(iroute.match) !== null) {
        iroute.param = hash.match(iroute.match);
        result = iroute;
      }
      if (typeof iroute.match === "function" && iroute.match(hash)) {
        route.param = hash;
        result = iroute;
      }
    });

    return result;
  },
  start: function start() {
    window.addEventListener("hashchange", function (e) {
      var oldHash = e.oldURL.match(/#(.+)/);
      var newHash = e.newURL.match(/#(.+)/);
      if (oldHash !== null) {
        oldHash = oldHash[1];
      } else {
        oldHash = "";
      };
      if (newHash !== null) {
        newHash = newHash[1];
      } else {
        newHash = "";
      };
      route.change(oldHash, newHash);
    });
    this.change("", window.location.hash.slice(1));
  },
  change: function change(oldHash, newHash) {
    var iroute = route.interpret(oldHash);
    if (!iroute) {
      console.error("interpret(oldHash) \u043D\u0435 \u043D\u0430\u0448\u0451\u043B route!");
      iroute = route.interpret("");
    };
    if (typeof iroute.onLeave === "function") {
      Promise.resolve(iroute.param).then(iroute.onLeave);
    }
    iroute = route.interpret(newHash);
    if (!iroute) {
      console.error("interpret(newHash) \u043D\u0435 \u043D\u0430\u0448\u0451\u043B route!");
      iroute = route.interpret("");
    };
    this.position = newHash;
    if (typeof iroute.onEnter === "function") {
      Promise.resolve(iroute.param).then(iroute.onEnter);
    }
    if (typeof iroute.onBefore === "function") {
      Promise.resolve(iroute.param).then(iroute.onBefore);
    }
  }
};

var text = void 0,
    renderText = void 0,
    canvas = void 0,
    refreshCanvas = void 0,
    renderCanvas = void 0,
    svg = void 0,
    refreshSvg = void 0,
    renderSvg = void 0;
var readStorage = function readStorage(cb) {
  if (lifeGame.currentArr && lifeGame.currentArr.length > 0) {
    cb(lifeGame.currentArr);
    return;
  };
  (0, _main.session)("lastArray").then(function (arr) {
    if (arr) lifeGame.currentArr = arr;
    (0, _main.session)("field").then(function (field) {
      lifeGame.x = +field[0];
      lifeGame.y = +field[1];
      cb(arr);
    });
  });
};

var checkLinks = function checkLinks() {
  if (route.position === "") ;
  var links = document.querySelectorAll(".route");
  links.forEach(function (elem) {
    elem.classList.remove("press");
    if (elem.innerText === route.position) {
      elem.classList.add("press");
    }
  });
};

route.routes = [{
  name: "index",
  match: function match(hash) {
    return hash === "";
  },
  onEnter: function onEnter() {
    main.innerText = "\n        \u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0436\u0438\u043C \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u0438\u0433\u0440\u044B ('Text', 'Canvas' \u0438\u043B\u0438 'SVG')\n        ";
  },
  onLeave: function onLeave() {
    main.innerHTML = "";
  }
}, {
  name: "text",
  match: "Text",
  onEnter: function onEnter() {
    checkLinks();
    text = new _text.Text(main);
    text.create();
    renderText = text.render.bind(text);
    readStorage(renderText);
    eb.on("changeArr", renderText);
    controlPanel.create();
  },

  onLeave: function onLeave() {
    text.clear();
    eb.off("changeArr", renderText);
    text = null;
    controlPanel.delete();
  }
}, {
  name: "canvas",
  match: "Canvas",
  onEnter: function onEnter(arr) {
    checkLinks();
    canvas = new _canvas.Canvas(main, 20);
    canvas.refresh();
    refreshCanvas = canvas.refresh.bind(canvas);
    renderCanvas = canvas.render.bind(canvas);
    readStorage(function (arr) {
      refreshCanvas();renderCanvas(arr);
    });
    eb.on("createField", refreshCanvas);
    eb.on("changeArr", renderCanvas);
    controlPanel.create();
  },
  onLeave: function onLeave() {
    eb.off("createField", refreshCanvas);
    eb.off("changeArr", renderCanvas);
    canvas = null;
    controlPanel.delete();
  }
}, {
  name: "svg",
  match: "SVG",
  onEnter: function onEnter() {
    checkLinks();
    svg = new _svg.Svg(main, 20);
    svg.refresh();
    refreshSvg = svg.refresh.bind(svg);
    renderSvg = svg.render.bind(svg);
    readStorage(function (arr) {
      refreshSvg();renderSvg(arr);
    });
    eb.on("createField", refreshSvg);
    eb.on("changeArr", renderSvg);
    controlPanel.create();
  },
  onLeave: function onLeave() {
    eb.off("createField", refreshSvg);
    eb.off("changeArr", renderSvg);
    svg = null;
    controlPanel.delete();
  }
}, {
  name: "about",
  match: "About",
  onEnter: function onEnter() {
    checkLinks();
    main.innerHTML = "\n        <p>\u0414\u0430\u043D\u043D\u043E\u0435 \u0432\u0435\u0431-\u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 - \u0440\u0435\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F \u0438\u0433\u0440\u044B \"\u0416\u0438\u0437\u043D\u044C\".</p>\n        <p>\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0438 \u043F\u0440\u0430\u0432\u0438\u043B\u0430 \u0438\u0433\u0440\u044B \u0432\u044B \u043C\u043E\u0436\u0435\u0442\u0435 \u043F\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0432 \u0432\u0438\u043A\u0438\u043F\u0435\u0434\u0438\u0438.</p>\n        <a target=\"_blank\" href=\"https://ru.wikipedia.org/wiki/%D0%98%D0%B3%D1%80%D0%B0_%C2%AB%D0%96%D0%B8%D0%B7%D0%BD%D1%8C%C2%BB\"><img src=\"other/wiki.png\" alt=\"\"></a>\n        <p class=\"about\">\u0412 \u0432\u0435\u0440\u0445\u043D\u0435\u0439 \u0447\u0430\u0441\u0442\u0438 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F - \u043F\u0430\u043D\u0435\u043B\u044C \u043F\u0435\u0440\u0435\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u044F \u043F\u043E \u0440\u0435\u0436\u0438\u043C\u0430\u043C \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u0438\u0433\u0440\u044B (\"Text\",\"Canvas\",\"SVG\"), \u0430 \u0442\u0430\u043A\u0436\u0435 \u0432\u043A\u043B\u0430\u0434\u043A\u0430 \"About\", \u043A\u043E\u0442\u043E\u0440\u0443\u044E \u0432\u044B \u0441\u0435\u0439\u0447\u0430\u0441 \u0447\u0438\u0442\u0430\u0435\u0442\u0435.</p>\n        <p class=\"about\">\u0426\u0435\u043D\u0442\u0440\u0430\u043B\u044C\u043D\u0430\u044F \u0447\u0430\u0441\u0442\u044C - \u043F\u043E\u043B\u0435 \u0438\u0433\u0440\u044B, \"\u043A\u043B\u0438\u043A\u0430\u044F\" \u043F\u043E \u043A\u043E\u0442\u043E\u0440\u043E\u043C\u0443 \u0437\u0430\u0440\u043E\u0436\u0434\u0430\u0435\u0442\u0441\u044F/\u0443\u0433\u0430\u0441\u0430\u0435\u0442 \"\u0436\u0438\u0437\u043D\u044C\".</p>\n        <p class=\"about\">\u0412 \u0440\u0435\u0436\u0438\u043C\u0430\u0445 \u0438\u0433\u0440\u044B, \u0432 \u043D\u0438\u0436\u043D\u0435\u0439 \u0447\u0430\u0441\u0442\u0438 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F, \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044F: \u0441\u043B\u0435\u0432\u0430 - \u043F\u0430\u043D\u0435\u043B\u044C \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u0438\u0433\u0440\u043E\u0439: \u043A\u043D\u043E\u043F\u043A\u0438 \"Play\" \u0438 \"Pause\" \u0434\u043B\u044F \u0437\u0430\u043F\u0443\u0441\u043A\u0430 \u0438 \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0438 \u0438\u0433\u0440\u044B, \u043A\u043D\u043E\u043F\u043A\u0438 \u043F\u0435\u0440\u0435\u0445\u043E\u0434\u0430 \u043F\u043E \u0438\u0441\u0442\u043E\u0440\u0438\u0438 \u0438\u0433\u0440\u044B \"\u0432\u043F\u0435\u0440\u0435\u0434/\u043D\u0430\u0437\u0430\u0434\" (\u0440\u0430\u0431\u043E\u0442\u0430\u044E\u0442 \u0442\u043E\u043B\u044C\u043A\u043E \u0432 \u0440\u0435\u0436\u0438\u043C\u0435 \"Pause\"); \u0432 \u0446\u0435\u043D\u0442\u0440\u0435 - \"\u043F\u043E\u043B\u0437\u0443\u043D\u043E\u043A\" \u0440\u0435\u0433\u0443\u043B\u0438\u0440\u043E\u0432\u043A\u0438 \u0441\u043A\u043E\u0440\u043E\u0441\u0442\u0438 \u0438\u0433\u0440\u044B; \u0441\u043F\u0440\u0430\u0432\u0430 - \u043E\u043A\u043D\u043E \u0432\u0432\u043E\u0434\u0430 \u0434\u043B\u044F \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F \u043F\u043E\u043B\u044F \u0438\u0433\u0440\u044B.</p>";
    lifeGame.stop();
  },
  onLeave: function onLeave() {
    main.innerHTML = "";
    // lifeGame.start();
  }
}];

route.start();

},{"./canvas":1,"./eb":3,"./header":4,"./main.js":6,"./panel":7,"./svg":10,"./text":11}],9:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Slider = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _router = require("./router");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Slider = function () {
  function Slider(where) {
    _classCallCheck(this, Slider);

    this.parent = where;
    this.create();
  }

  _createClass(Slider, [{
    key: "create",
    value: function create() {
      this.parent.innerHTML = "<div id=\"line\"><div id=\"clit\"></div></div>";
      this.elem = this.parent.children[0];
      this.events();
    }
  }, {
    key: "events",
    value: function events() {
      this.elem.addEventListener("mousedown", function (e) {
        if (!e.target.matches("#clit")) return;
        e.preventDefault();
        var clit = e.target;
        var line = document.querySelector("#line");
        var coordsLine = line.getBoundingClientRect();
        var coordsClit = clit.getBoundingClientRect();
        var leftLimit = coordsLine.left + window.pageXOffset;
        var rightLimit = coordsLine.right - coordsClit.width + window.pageXOffset;
        var offset = e.clientX - coordsClit.x;
        clit.style.position = "absolute";
        clit.style.left = e.clientX - offset + window.pageXOffset + "px";
        document.onmousemove = function (ev) {
          console.log("onmousemove");
          var x = ev.clientX - offset + window.pageXOffset;
          if (x < leftLimit) x = leftLimit;
          if (x > rightLimit) x = rightLimit;
          clit.style.left = x + "px";
          var interval = (x - leftLimit + 40) / (coordsLine.width - coordsClit.width) * 1000;
          _router.lifeGame.interval = interval;
        };
        document.addEventListener("mouseup", function () {
          console.log("mouseup");
          var coordsClit = clit.getBoundingClientRect();
          var coordsLine = line.getBoundingClientRect();
          clit.style.position = "relative";
          clit.style.left = coordsClit.left - coordsLine.left + "px";
          document.onmousemove = null;
        });
        return false;
      });
    }
  }]);

  return Slider;
}();

;

exports.Slider = Slider;

},{"./router":8}],10:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Svg = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _router = require("./router");

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Svg = function () {
  function Svg(where, cell) {
    _classCallCheck(this, Svg);

    this.elem = where;
    this.cell = cell || 20;
  }

  _createClass(Svg, [{
    key: "create",
    value: function create() {
      this.x = this.cell * _router.lifeGame.x || 0;
      this.y = this.cell * _router.lifeGame.y || 0;
      this.elem.innerHTML = "\n      <svg id=\"svg\" version=\"1.1\" baseProfile=\"full\" width=\"" + this.x + "\" height=\"" + this.y + "\" xmlns=\"http://www.w3.org/2000/svg\">\n      </svg>";
      this.svg = this.elem.querySelector("#svg");
    }
  }, {
    key: "render",
    value: function render(arr) {
      var _this = this;

      var square = function square(i, j) {
        var x = j * _this.cell;
        var y = i * _this.cell;
        _this.svg.innerHTML += "<rect x=\"" + x + "\" y=\"" + y + "\" width=\"" + _this.cell + "\" height=\"" + _this.cell + "\" fill=\"red\"/>";
      };
      this.svg.innerHTML = "";
      arr.forEach(function (item, i) {
        item.forEach(function (elem, j) {
          if (elem) {
            square(i, j);
          }
        });
      });
    }
  }, {
    key: "clear",
    value: function clear() {
      this.elem.innerHTML = "";
    }
  }, {
    key: "refresh",
    value: function refresh() {
      this.clear();
      this.create();
    }
  }]);

  return Svg;
}();

;

exports.Svg = Svg;

},{"./router":8}],11:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Text = function () {
  function Text(where) {
    _classCallCheck(this, Text);

    this.elem = where;
  }

  _createClass(Text, [{
    key: "create",
    value: function create() {
      this.elem.innerHTML = "<pre id=\"text\"></pre>";
      this.pre = this.elem.querySelector("#text");
    }
  }, {
    key: "render",
    value: function render(arr) {
      if (!arr) return;
      var str = "";
      arr.map(function (elem) {
        elem.map(function (num) {
          str += +num ? "X" : " ";
        });
        str += "\n";
      });
      this.pre.innerText = str;
    }
  }, {
    key: "clear",
    value: function clear() {
      this.elem.innerHTML = "";
    }
  }]);

  return Text;
}();

exports.Text = Text;

},{}]},{},[8]);
